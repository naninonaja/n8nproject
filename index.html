<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task PWA - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .task-card {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }
        .task-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }
        .status-todo { background-color: #fef3c7; color: #b45309; }
        .status-done { background-color: #d1fae5; color: #065f46; text-decoration: line-through; }
        .btn-primary {
            background-color: #4f46e5;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 600;
            transition: background-color 0.2s;
        }
        .btn-primary:hover { background-color: #4338ca; }
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° Done/Reopen */
        .btn-done { background-color: #10b981; color: white; }
        .btn-done:hover { background-color: #059669; }
        .btn-reopen { background-color: #f97316; color: white; }
        .btn-reopen:hover { background-color: #ea580c; }
    </style>
</head>
<body class="p-4 sm:p-8">

    <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô -->
    <div id="addTaskModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden flex items-center justify-center p-4 z-50">
        <div class="bg-white p-6 rounded-xl shadow-2xl w-full max-w-md">
            <h2 class="text-2xl font-bold mb-4 text-gray-800">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
            <form id="taskForm" onsubmit="handleAddTask(event)">
                <div class="mb-4">
                    <label for="taskName" class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô:</label>
                    <input type="text" id="taskName" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="mb-6">
                    <label for="dueDate" class="block text-sm font-medium text-gray-700 mb-1">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á:</label>
                    <input type="date" id="dueDate" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="closeModal()" class="px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition duration-150">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button type="submit" class="btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô</button>
                </div>
            </form>
        </div>
    </div>

    <div class="max-w-4xl mx-auto">
        <header class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-extrabold text-gray-900">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á (Apps Script API)</h1>
            <div class="flex space-x-3">
                <button onclick="openModal()" class="btn-primary flex items-center space-x-2">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>
                    <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</span>
                </button>
                <button onclick="fetchTasks()" id="refreshButton" class="p-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition duration-150" title="Refresh">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181-3.181m0 0a1.25 1.25 0 012.247 1.099l-.039 1.107L16.02 12m-2.193 5.48a1.25 1.25 0 001.099 2.247h.001M21 12l-3.181 3.181M18.819 8.819a1.25 1.25 0 001.099 2.247l.039 1.107L8 15" />
                    </svg>
                </button>
            </div>
        </header>

        <!-- Message/Loading Area -->
        <div id="messageArea" class="mb-4 p-3 rounded-lg text-center font-medium bg-blue-100 text-blue-700 hidden"></div>
        <div id="loadingIndicator" class="text-center py-10 hidden">
            <svg class="animate-spin h-8 w-8 text-indigo-500 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="mt-2 text-gray-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏á‡∏≤‡∏ô...</p>
        </div>

        <!-- Task List Area -->
        <div id="taskList" class="space-y-4">
            <!-- Tasks will be rendered here -->
        </div>

        <div id="emptyMessage" class="text-center py-16 text-gray-500 text-lg hidden">
            <p>üéâ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á! ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å</p>
            <p class="mt-2 text-sm">‡∏Å‡∏î "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà</p>
        </div>
    </div>

    <script>
        // *** 1. CONFIGURATION: ‡∏ß‡∏≤‡∏á Web App URL ‡∏Ç‡∏≠‡∏á Google Apps Script ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2 ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ***
        const GAS_API_URL = "YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE"; 
        
        // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        let tasksData = [];

        // ------------------ UTILITY FUNCTIONS ------------------

        /** ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Success/Error) */
        function showMessage(message, isSuccess = true) {
            const area = document.getElementById('messageArea');
            area.textContent = message;
            area.classList.remove('hidden', 'bg-red-100', 'text-red-700', 'bg-blue-100', 'text-blue-700');
            area.classList.add(isSuccess ? 'bg-blue-100' : 'bg-red-100', isSuccess ? 'text-blue-700' : 'text-red-700');
            
            setTimeout(() => {
                area.classList.add('hidden');
            }, 5000);
        }

        /** ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î Loading Indicator */
        function setLoading(isLoading) {
            document.getElementById('loadingIndicator').classList.toggle('hidden', !isLoading);
            document.getElementById('refreshButton').disabled = isLoading;
        }

        /** ‡πÄ‡∏õ‡∏¥‡∏î Modal ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô */
        function openModal() {
            document.getElementById('addTaskModal').classList.remove('hidden');
        }

        /** ‡∏õ‡∏¥‡∏î Modal ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô */
        function closeModal() {
            document.getElementById('addTaskModal').classList.add('hidden');
            document.getElementById('taskForm').reset();
        }

        // ------------------ API CALLS (GET/POST) ------------------
        
        /** ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å Google Apps Script */
        async function fetchTasks() {
            setLoading(true);
            try {
                const response = await fetch(GAS_API_URL, {
                    method: 'GET', // GAS doGet() ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
                if (result.success && result.tasks) {
                    tasksData = result.tasks;
                    renderTasks();
                    showMessage("‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!", true);
                } else {
                    showMessage(result.message || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏á‡∏≤‡∏ô.", false);
                }

            } catch (error) {
                console.error("Fetch Tasks Error:", error);
                showMessage("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Apps Script ‡πÑ‡∏î‡πâ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£ Deploy.", false);
            } finally {
                setLoading(false);
            }
        }

        /** ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà */
        async function handleAddTask(event) {
            event.preventDefault();
            setLoading(true);

            const taskName = document.getElementById('taskName').value;
            const dueDate = document.getElementById('dueDate').value;

            const payload = {
                action: "new_task", // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ GAS ‡∏£‡∏±‡∏ô handleNewTask
                data: {
                    "Task Name": taskName,
                    "Due Date": dueDate,
                    "Status": "To Do"
                }
            };

            try {
                const response = await fetch(GAS_API_URL, {
                    method: 'POST', // GAS doPost() ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();

                if (result.success) {
                    showMessage("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£...", true);
                    closeModal();
                    await fetchTasks(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
                } else {
                    showMessage(result.message || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô.", false);
                }

            } catch (error) {
                console.error("Add Task Error:", error);
                showMessage("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ ‡∏•‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console", false);
            } finally {
                setLoading(false);
            }
        }

        /** ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (Done/Reopen) */
        async function updateTaskStatus(rowId, newStatus) {
            setLoading(true);

            const payload = {
                action: "update_status", // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ GAS ‡∏£‡∏±‡∏ô handleUpdateStatus
                row_id: rowId,
                new_status: newStatus
            };

            try {
                const response = await fetch(GAS_API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();

                if (result.success) {
                    showMessage(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô '${newStatus}' ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£...`, true);
                    await fetchTasks(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
                } else {
                    showMessage(result.message || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞.", false);
                }

            } catch (error) {
                console.error("Update Status Error:", error);
                showMessage("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏î‡πâ", false);
            } finally {
                setLoading(false);
            }
        }

        // ------------------ RENDERING ------------------

        /** ‡πÅ‡∏õ‡∏•‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≤‡∏Å YYYY-MM-DD ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ó‡∏¢ (dd/MM/yyyy) */
        function formatDateThai(dateString) {
            if (!dateString) return '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≥‡∏´‡∏ô‡∏î';
            try {
                const date = new Date(dateString);
                // ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô UTC ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Timezone
                const utcDate = new Date(date.getTime() + date.getTimezoneOffset() * 60000); 
                
                const options = { year: 'numeric', month: 'numeric', day: 'numeric', timeZone: 'Asia/Bangkok' };
                return utcDate.toLocaleDateString('th-TH', options);
            } catch (e) {
                return dateString;
            }
        }

        /** ‡∏™‡∏£‡πâ‡∏≤‡∏á Task Card ‡πÉ‡∏ô HTML */
        function createTaskCard(task) {
            const isDone = task.Status === 'Done';
            const statusClass = isDone ? 'status-done' : 'status-todo';
            const buttonText = isDone ? 'Reopen' : 'Mark as Done';
            const nextStatus = isDone ? 'To Do' : 'Done';
            const buttonClass = isDone ? 'btn-reopen' : 'btn-done';

            const card = document.createElement('div');
            card.className = `task-card bg-white p-5 rounded-xl flex flex-col sm:flex-row justify-between items-start sm:items-center border-l-8 ${isDone ? 'border-green-500' : 'border-yellow-500'}`;
            
            card.innerHTML = `
                <div class="flex-1 min-w-0 mb-3 sm:mb-0">
                    <div class="text-xs font-semibold uppercase rounded-full px-2 py-0.5 w-fit ${statusClass} mb-1">
                        ${task.Status}
                    </div>
                    <div class="text-lg font-bold text-gray-800 break-words">${task['Task Name']}</div>
                    <div class="text-sm text-gray-500 mt-1">
                        <span class="font-medium">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡πà‡∏á:</span> ${formatDateThai(task['Due Date'])}
                        <span class="ml-3 text-xs text-gray-400">| ID: ${task.row_id}</span>
                    </div>
                </div>
                <div class="flex-shrink-0">
                    <button 
                        onclick="updateTaskStatus('${task.row_id}', '${nextStatus}')" 
                        class="text-sm ${buttonClass} py-2 px-4 rounded-lg hover:opacity-90 transition duration-150 w-full sm:w-auto"
                    >
                        ${buttonText}
                    </button>
                </div>
            `;
            return card;
        }

        /** Render ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î */
        function renderTasks() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏°
            
            if (tasksData.length === 0) {
                document.getElementById('emptyMessage').classList.remove('hidden');
                return;
            }
            document.getElementById('emptyMessage').classList.add('hidden');

            // ‡πÅ‡∏¢‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á (To Do) ‡∏Å‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß (Done)
            const todoTasks = tasksData.filter(t => t.Status === 'To Do');
            const doneTasks = tasksData.filter(t => t.Status === 'Done');

            // ‡πÅ‡∏™‡∏î‡∏á To Do ‡∏Å‡πà‡∏≠‡∏ô
            todoTasks.forEach(task => {
                taskList.appendChild(createTaskCard(task));
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á Done ‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏á
            if (doneTasks.length > 0) {
                 const doneHeader = document.createElement('h2');
                 doneHeader.className = 'text-xl font-bold text-gray-700 mt-8 mb-4 border-b pb-1';
                 doneHeader.textContent = `‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß (${doneTasks.length})`;
                 taskList.appendChild(doneHeader);

                 doneTasks.forEach(task => {
                    taskList.appendChild(createTaskCard(task));
                });
            }
        }

        // ------------------ INITIALIZATION ------------------
        window.onload = function() {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
            if (GAS_API_URL === "https://script.google.com/macros/s/AKfycbzpOmA_mKknmAds9jRTlRmtpOl0CXDhhG0TTRvIWOOuR04echFUMS_8b5SN_OGs-xKp/exec") {
                showMessage("üö® ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô GAS_API_URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!", false);
                return;
            }
            fetchTasks();
        };

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ CORS preflight ‡πÉ‡∏ô PWA (‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô)
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('addTaskModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('addTaskModal')) {
                    closeModal();
                }
            });
        });

    </script>
</body>
</html>
```
eof

### üö® **‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)**

1.  **‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å GAS API URL:** ‡∏ô‡∏≥ `Web App URL` ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2 (‡∏Å‡∏≤‡∏£ Deploy)
2.  **‡∏ß‡∏≤‡∏á‡πÉ‡∏ô PWA:** ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå **`index.html`** ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ:
    ```javascript
    const GAS_API_URL = "YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE"; 
    
